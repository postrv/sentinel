name = "sentinel"
main = "src/index.ts"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

# Development settings
[dev]
port = 8787
local_protocol = "http"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "sentinel-db"
database_id = "16180dc5-7a35-41f6-88df-77c4d1330b1c"
migrations_dir = "migrations"

# KV Namespace for caching
[[kv_namespaces]]
binding = "CACHE"
id = "b7829167f40044439c3ae4a77ac7c3b4"

# R2 Bucket for artifacts
[[r2_buckets]]
binding = "ARTIFACTS"
bucket_name = "sentinel-artifacts"

# Environment variables (secrets should be set via `wrangler secret put`)
[vars]
ENVIRONMENT = "production"

# Rate limiting configuration (authenticated users)
[vars.rate_limits]
requests_per_minute = 30
requests_per_day = 1000

# Build configuration
[build]
command = "npm run typecheck"

# Secrets (set via CLI: wrangler secret put SECRET_NAME)
# Required secrets:
# - VT_API_KEY: VirusTotal API key
# - ABUSEIPDB_KEY: AbuseIPDB API key
# - SHODAN_KEY: Shodan API key
# - GREYNOISE_KEY: GreyNoise API key
# - URLSCAN_KEY: URLScan.io API key
# - ANTHROPIC_API_KEY: Anthropic Claude API key
# - API_SECRET_KEY: Secret key for API authentication

# Environments (optional custom domains)
# [env.production]
# routes = [
#   { pattern = "sentinel.yourdomain.com/*", zone_name = "yourdomain.com" }
# ]
